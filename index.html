<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Prediction Bot with Loading & Login</title>
<style>
  * { margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;}
  body, html { width:100%; height:100%; overflow:hidden; }

  /* ---------- Loading Screen ---------- */
  #loadingScreen {
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    width:100vw; height:100vh;
    background: linear-gradient(135deg, #1e3c72, #2a5298);
    color:#00ff99;
  }
  #loadingBar { width:80%; height:20px; border-radius:10px; background:#222; margin-top:20px; overflow:hidden; }
  #loadingBarInner { width:0%; height:100%; background: #00ff99; border-radius:10px; }
  #loadingPercent { margin-top:10px; font-weight:700; font-size:20px; }

  /* ---------- Login Screen ---------- */
  #loginScreen {
    display:none;
    justify-content:center;
    align-items:center;
    flex-direction:column;
    width:100vw; height:100vh;
    background:#121212;
    color:#00ff99;
  }
  #tokenInput {
    padding:8px 12px;
    font-size:16px;
    border-radius:6px;
    border:2px solid #00ff99;
    margin-bottom:15px;
    text-align:center;
    color:#00ff99;
    background:#222;
    outline:none;
  }
  #tokenInput:focus { border-color:#ff4d4d; }
  #tokenBox {
    font-size:20px;
    font-weight:700;
    padding:10px 20px;
    margin-bottom:20px;
    border:2px dashed #00ff99;
    border-radius:10px;
    animation: pulse 1s infinite alternate;
    text-align:center;
  }
  @keyframes pulse { from { transform:scale(1); color:#00ff99; } to { transform:scale(1.2); color:#ff4d4d; } }
  #loginBtn {
    padding:8px 20px;
    font-weight:700;
    font-size:16px;
    border:none;
    border-radius:6px;
    background:#00ff99;
    color:#121212;
    cursor:pointer;
    transition:0.3s;
  }
  #loginBtn:hover { background:#ff4d4d; color:#fff; }

  /* ---------- Prediction Bot Screen ---------- */
  #botScreen {
    display:none;
    padding:10px;
    background:#121212;
    color:#00ff99;
    font-size:14px;
    height:100vh;
    overflow:auto;
  }
  .container { display:flex; justify-content:space-between; gap:20px; max-width:400px; margin:auto; padding:15px; background:#222; border-radius:10px; }
  .box { flex:1; }
  h3 { margin:0 0 10px 0; font-weight:700; text-align:center; font-size:16px; color:#00ff99; }
  button { display:block; margin:0 auto 10px auto; padding:5px 12px; background:#00ff99; border:none; border-radius:6px; color:#121212; font-weight:700; cursor:pointer; font-size:14px; }
  .period { text-align:center; margin-bottom:8px; font-weight:600; }
  .signal { font-weight:900; text-align:center; font-size:18px; color:#4d94ff; text-shadow:0 0 8px #4d94ff; }
  .signal.big { color:#ff4d4d; text-shadow:0 0 8px #ff4d4d; }
  .history-list { list-style:none; padding:0; margin:0; max-height:130px; overflow-y:auto; }
  .history-list li { background:#333; margin-bottom:5px; padding:4px 8px; display:flex; justify-content:space-between; border-radius:6px; font-weight:600; font-size:12px; }
  .history-list li .number.big { color:#ff4d4d; }
  .history-list li .number.small { color:#4d94ff; }
  @media (max-width:480px) { .container { flex-direction:column; max-width:95vw; } }
</style>
</head>
<body>

<!-- Loading Screen -->
<div id="loadingScreen">
  <h1>Prediction Bot Loading...</h1>
  <div id="loadingBar"><div id="loadingBarInner"></div></div>
  <div id="loadingPercent">0%</div>
</div>

<!-- Login Screen -->
<div id="loginScreen">
  <div id="tokenBox">Telegram:@FORID0KSUPPORT</div>
  <input type="text" id="tokenInput" placeholder="Enter Token"/>
  <button id="loginBtn">Login</button>
</div>

<!-- Prediction Bot Screen -->
<div id="botScreen">
  <div class="container">
    <div class="box" id="predictionBox">
      <h3>Prediction Box</h3>
      <button id="botToggleBtn">Start Bot</button>
      <div class="period" id="predictionPeriod">Period: -</div>
      <div class="signal" id="predictionSignal">-</div>
    </div>
    <div class="box" id="historyBox">
      <h3>Result History</h3>
      <div class="period" id="latestPeriod">Latest Period: -</div>
      <ul class="history-list" id="historyList"></ul>
    </div>
  </div>
</div>

<script>
/* ---------- Loading Screen ---------- */
const loadingBarInner = document.getElementById('loadingBarInner');
const loadingPercent = document.getElementById('loadingPercent');
const loadingScreen = document.getElementById('loadingScreen');
const loginScreen = document.getElementById('loginScreen');
const tokenInput = document.getElementById('tokenInput');
const loginBtn = document.getElementById('loginBtn');
const botScreen = document.getElementById('botScreen');

let percent = 0;
const loadingInterval = setInterval(() => {
  percent++;
  loadingBarInner.style.width = percent + '%';
  loadingPercent.textContent = percent + '%';
  if(percent >= 100){
    clearInterval(loadingInterval);
    loadingScreen.style.display = 'none';
    loginScreen.style.display = 'flex';
  }
}, 20);

/* ---------- Token Login ---------- */
loginBtn.addEventListener('click', () => {
  if(tokenInput.value === 'forid0k1122'){
    loginScreen.style.display = 'none';
    botScreen.style.display = 'block';
  } else {
    alert('Invalid Token! Try Again.');
    tokenInput.value = '';
  }
});

/* ---------- Prediction Bot ---------- */
const predictionPeriodEl = document.getElementById('predictionPeriod');
const predictionSignalEl = document.getElementById('predictionSignal');
const latestPeriodEl = document.getElementById('latestPeriod');
const historyListEl = document.getElementById('historyList');
const botToggleBtn = document.getElementById('botToggleBtn');

let botRunning = false;
let predictionInterval = null;
let historyInterval = null;
const apiURL = 'https://draw.ar-lottery01.com/WinGo/WinGo_30S/GetHistoryIssuePage.json';

function getBigSmall(number){ return number >= 5 ? 'BIG' : 'SMALL'; }

async function fetchHistory(){
  try{
    const res = await fetch(apiURL);
    const data = await res.json();
    if(data.code === 0 && data.data && data.data.list) return data.data.list;
    return [];
  } catch(e){ console.error(e); return []; }
}

async function updateHistory(){
  const history = await fetchHistory();
  if(!history.length) return;
  const sorted = history.sort((a,b)=> b.issueNumber.localeCompare(a.issueNumber));
  const latestIssue = sorted[0];
  latestPeriodEl.textContent = 'Latest Period: ' + latestIssue.issueNumber;

  const last4 = sorted.slice(0,4);
  historyListEl.innerHTML = '';
  last4.forEach(item=>{
    const li = document.createElement('li');
    const bs = getBigSmall(item.number);
    li.innerHTML = `<span>${item.issueNumber}</span><span class="number ${bs.toLowerCase()}">${item.number}</span>`;
    historyListEl.appendChild(li);
  });
}

async function updatePrediction(){
  const history = await fetchHistory();
  if(!history.length) return;
  const sorted = history.sort((a,b)=> b.issueNumber.localeCompare(a.issueNumber));
  const latestIssue = sorted[0];
  let latestNumber = latestIssue.issueNumber;

  let prefix = latestNumber.slice(0,13);
  let suffix = latestNumber.slice(13);
  let suffixNum = parseInt(suffix||'0',10)+1;
  let predictionPeriod = prefix + suffixNum.toString().padStart(suffix.length||1,'0');
  predictionPeriodEl.textContent = 'Period: ' + predictionPeriod;

  const last3 = sorted.slice(0,3);
  let bigCount=0, smallCount=0;
  last3.forEach(item=> getBigSmall(item.number)==='BIG'?bigCount++:smallCount++);
  let signal = 'NEUTRAL';
  if(bigCount>=2) signal='BIG';
  else if(smallCount>=2) signal='SMALL';

  predictionSignalEl.textContent=signal;
  predictionSignalEl.classList.remove('big');
  predictionSignalEl.style.textShadow='';
  if(signal==='BIG') predictionSignalEl.classList.add('big');
  else if(signal==='SMALL'){ predictionSignalEl.style.color='#4d94ff'; predictionSignalEl.style.textShadow='0 0 8px #4d94ff'; }
  else{ predictionSignalEl.style.color='#00ff99'; predictionSignalEl.style.textShadow='0 0 5px #00ff99'; }
}

function startBot(){
  if(botRunning) return;
  botRunning = true;
  botToggleBtn.textContent='Stop Bot';
  updatePrediction(); updateHistory();
  predictionInterval=setInterval(updatePrediction,2000);
  historyInterval=setInterval(updateHistory,1000);
}

function stopBot(){
  if(!botRunning) return;
  botRunning = false;
  botToggleBtn.textContent='Start Bot';
  clearInterval(predictionInterval);
  clearInterval(historyInterval);
  predictionPeriodEl.textContent='Period: -';
  predictionSignalEl.textContent='-';
  predictionSignalEl.style.color='#00ff99';
  predictionSignalEl.style.textShadow='0 0 5px #00ff99';
  historyListEl.innerHTML='';
  latestPeriodEl.textContent='Latest Period: -';
}

botToggleBtn.addEventListener('click',()=>{ botRunning?stopBot():startBot(); });
</script>

</body>
</html>
